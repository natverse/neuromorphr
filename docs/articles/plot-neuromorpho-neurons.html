<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>plot-neuromorpho-neurons • neuromorphr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="plot-neuromorpho-neurons">
<meta property="og:description" content="neuromorphr">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">neuromorphr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/plot-neuromorpho-neurons.html">plot-neuromorpho-neurons</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/natverse/neuromorphr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>plot-neuromorpho-neurons</h1>
                        <h4 data-toc-skip class="author">Alexander
Bates</h4>
            
            <h4 data-toc-skip class="date">2019-04-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/natverse/neuromorphr/blob/HEAD/vignettes/plot-neuromorpho-neurons.Rmd" class="external-link"><code>vignettes/plot-neuromorpho-neurons.Rmd</code></a></small>
      <div class="hidden name"><code>plot-neuromorpho-neurons.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="whales-vs--elephants">Whales vs. elephants<a class="anchor" aria-label="anchor" href="#whales-vs--elephants"></a>
</h2>
<blockquote>
<p>“THE most obvious differences between different animals are
differences of size, but for some reason the zoologists have paid
singularly little attention to them. In a large textbook of zoology
before me I find no indication that the eagle is larger than the
sparrow, or the hippopotamus bigger than the hare, though some grudging
admissions are made in the case of the mouse and the whale. But yet it
is easy to show that a hare could not be as large as a hippopotamus, or
a while as small as a herring. For every type of animal there is a most
convenient size, and a large change in size inevitably carries with it a
change of form.” (<a href="https://archive.org/stream/OnBeingTheRightSize-J.B.S.Haldane/rightsize_djvu.txt" class="external-link">J.B.S.
Haldane</a>)</p>
</blockquote>
<p>It’s not often that you get to see neurons from both whales and
elephants. I wonder which animal has the larger neurons? And what papers
describe them? We can use <code>neuromorphr</code> alongside its
dependency, <code>nat</code> to plot neurons hosted and curated by <a href="http://neuromorpho.org" class="external-link">neuromorpho.org</a></p>
<div class="section level3">
<h3 id="find-neurons">Find neurons<a class="anchor" aria-label="anchor" href="#find-neurons"></a>
</h3>
<p>First, we need to find neuron names or neuron IDs for morphologies
hosted on <a href="http://neuromorpho.org" class="external-link">neuromorpho.org</a>. These
are required, because we need at least one of these two bits of
information in order to read neurons from the repository.</p>
<p>To find these items, let us search the repository for neurons from
the two groups of animal in which we are interested:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/natverse/neuromorphr" class="external-link">neuromorphr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/natverse/nat" class="external-link">nat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Hello neuromorpho.org, can you hear us?</span></span>
<span><span class="fu"><a href="../reference/neuromorpho_is_api_healthy.html">neuromorpho_is_api_healthy</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Check to see if we can talk to the neuromorpho API, otherwise we cannot continue</span></span>
<span></span>
<span><span class="co"># Do they have these two big beasts?</span></span>
<span><span class="va">all.species</span> <span class="op">=</span> <span class="fu"><a href="../reference/neuromorpho_field_entries.html">neuromorpho_field_entries</a></span><span class="op">(</span>field<span class="op">=</span><span class="st">"species"</span><span class="op">)</span></span>
<span><span class="va">whales</span> <span class="op">=</span> <span class="va">all.species</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"whale"</span>,<span class="va">all.species</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">whales</span><span class="op">)</span></span>
<span><span class="va">elephants</span> <span class="op">=</span> <span class="va">all.species</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"elephant"</span>,<span class="va">all.species</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">elephants</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Can we get some whale neurons</span></span>
<span><span class="va">whale.df</span> <span class="op">=</span> <span class="fu"><a href="../reference/neuromorpho_search.html">neuromorpho_search</a></span><span class="op">(</span>search_terms<span class="op">=</span><span class="st">"species:humpback whale"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># And the elephant ones!</span></span>
<span><span class="va">elephant.df</span> <span class="op">=</span> <span class="fu"><a href="../reference/neuromorpho_search.html">neuromorpho_search</a></span><span class="op">(</span>search_terms<span class="op">=</span><span class="st">"species:elephant"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># But we probably cannot easily compare different cell types. Which types do we have?</span></span>
<span><span class="va">tw</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">whale.df</span><span class="op">$</span><span class="va">cell_type</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"whale cell types:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tw</span><span class="op">)</span></span>
<span><span class="va">te</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">elephant.df</span><span class="op">$</span><span class="va">cell_type</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"elephant cell types:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">te</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's take only the pyramidal cells</span></span>
<span><span class="va">whale.neuron_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">whale.df</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"pyramidal"</span>,<span class="va">cell_type</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">neuron_name</span></span>
<span><span class="va">elephant.neuron_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">elephant.df</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"pyramidal"</span>,<span class="va">cell_type</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">neuron_name</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="read-neurons">Read neurons<a class="anchor" aria-label="anchor" href="#read-neurons"></a>
</h3>
<p>Armed with this information, we can now read the neurons as
<code>nat</code> package <code>neuronlist</code> objects. You can find a
detailed explanation of this data format, and its basic manipulation
with <code>nat</code> tools, <a href="https://jefferis.github.io/nat/" class="external-link">here</a>.</p>
<p>Sometimes reading neurons can take a while, because <a href="http://neuromorpho.org" class="external-link">neuromorpho.org</a> is fairly slow. We’ll
want to have <code>progress = TRUE</code> on in the following functions,
so that we get a sense for how long it’s taking.</p>
<p>These functions send asynchronous requests to the <a href="http://neuromorpho.org" class="external-link">neuromorpho.org</a> API in parallel in
order to speed things up. In one run, <code>batch.size</code> requests
are sent, and once this pool of requests has been processed, the
progress bar will update. You can increase this value to speed up the
read, but do not put it too high or <a href="http://neuromorpho.org" class="external-link">neuromorpho.org</a> will fail for capacity
reasons.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read the whale neurons</span></span>
<span><span class="va">whale.pyramidal.cells</span> <span class="op">=</span> <span class="fu"><a href="../reference/neuromorpho_read_neurons.html">neuromorpho_read_neurons</a></span><span class="op">(</span>neuron_name <span class="op">=</span> <span class="va">whale.neuron_names</span>, batch.size <span class="op">=</span> <span class="fl">2</span>, nat <span class="op">=</span> <span class="cn">TRUE</span>, progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># And read the elephant neurons</span></span>
<span><span class="va">elephant.pyramidal.cells</span> <span class="op">=</span> <span class="fu"><a href="../reference/neuromorpho_read_neurons.html">neuromorpho_read_neurons</a></span><span class="op">(</span>neuron_name <span class="op">=</span> <span class="va">elephant.neuron_names</span>, batch.size <span class="op">=</span> <span class="fl">2</span>, nat <span class="op">=</span> <span class="cn">TRUE</span>, progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-neurons">Plot neurons<a class="anchor" aria-label="anchor" href="#plot-neurons"></a>
</h3>
<p>Let’s plot these neocortical pyramidal cells. It is important to note
that since neurons are reconstructed from many different neural systems
and species, there is no ‘standard’ orientation. Instead,
neuromorpho.org’s standardisation process orients the morphologies by
placing the soma in the origin of coordinates and aligning the first
three principal components of all XYZ coordinates with heights, width,
and depth.</p>
<p>We can plot in 2D</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/nopen3d.html" class="external-link">nopen3d</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">whale.pyramidal.cells</span>, lwd <span class="op">=</span> <span class="fl">2</span>, soma <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deepskyblue1"</span>,<span class="st">"deepskyblue4"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">whale.pyramidal.cells</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">elephant.pyramidal.cells</span>, lwd <span class="op">=</span> <span class="fl">2</span>, soma <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"firebrick1"</span>,<span class="st">"firebrick4"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">elephant.pyramidal.cells</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And in 3D using <code>rgl</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hold right click to pan</span></span>
<span><span class="fu">nat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/nopen3d.html" class="external-link">nopen3d</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">whale.pyramidal.cells</span>, lwd <span class="op">=</span> <span class="fl">2</span>, soma <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deepskyblue1"</span>,<span class="st">"deepskyblue4"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">whale.pyramidal.cells</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">elephant.pyramidal.cells</span>, lwd <span class="op">=</span> <span class="fl">2</span>, soma <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"firebrick1"</span>,<span class="st">"firebrick4"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">elephant.pyramidal.cells</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="of-mice-and-whales">Of Mice and Whales<a class="anchor" aria-label="anchor" href="#of-mice-and-whales"></a>
</h3>
<p>So that’s interesting. But what about a small mammal - like a mouse?
Can we quickly do the same for this wee beastie?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find</span></span>
<span><span class="va">mouse.df</span> <span class="op">=</span> <span class="fu"><a href="../reference/neuromorpho_search.html">neuromorpho_search</a></span><span class="op">(</span>search_terms<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species:mouse"</span>, <span class="st">"brain_region:neocortex"</span><span class="op">)</span><span class="op">)</span> <span class="co"># takes a while, there's a lot of mouse data to look through!</span></span>
<span><span class="va">mouse.neuron_name</span> <span class="op">=</span> <span class="va">mouse.df</span><span class="op">$</span><span class="va">neuron_name</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"pyramidal"</span>,<span class="va">mouse.df</span><span class="op">$</span><span class="va">cell_type</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Read</span></span>
<span><span class="va">mouse.pyramidal.cells</span> <span class="op">=</span> <span class="fu"><a href="../reference/neuromorpho_read_neurons.html">neuromorpho_read_neurons</a></span><span class="op">(</span>neuron_name <span class="op">=</span> <span class="va">mouse.neuron_name</span>, batch.size <span class="op">=</span> <span class="fl">2</span>, nat <span class="op">=</span> <span class="cn">TRUE</span>, progress <span class="op">=</span> <span class="cn">TRUE</span>, find <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## warnings? - sometimes a file is missing from the repository it seems, or can otherwise not be accessed, so we lost a few cells ...</span></span>
<span><span class="co">## In fact, the file names on neuromorpho are not entirely consistent with one another. You can try using find = TRUE, which will</span></span>
<span><span class="co">## mean that this function runs slower, but scrapes the webpages for the correct dowbnload URL, which may slightly improve neuron retrieval </span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu">nat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/nopen3d.html" class="external-link">nopen3d</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">whale.pyramidal.cells</span>, lwd <span class="op">=</span> <span class="fl">2</span>, soma <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deepskyblue1"</span>,<span class="st">"deepskyblue4"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">whale.pyramidal.cells</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">elephant.pyramidal.cells</span>, lwd <span class="op">=</span> <span class="fl">2</span>, soma <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"firebrick1"</span>,<span class="st">"firebrick4"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">elephant.pyramidal.cells</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">mouse.pyramidal.cells</span>, lwd <span class="op">=</span> <span class="fl">2</span>, soma <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkolivegreen1"</span>,<span class="st">"darkolivegreen4"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mouse.pyramidal.cells</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can actually pull some of their metrics and plot them, to see the
quantitative differences</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Put names together</span></span>
<span><span class="va">metrics.neuron_name</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">whale.pyramidal.cells</span><span class="op">[</span>,<span class="st">"neuron_name"</span><span class="op">]</span>, <span class="va">elephant.pyramidal.cells</span><span class="op">[</span>,<span class="st">"neuron_name"</span><span class="op">]</span>, <span class="va">mouse.pyramidal.cells</span><span class="op">[</span>,<span class="st">"neuron_name"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pull measurements, in a data frame</span></span>
<span><span class="va">measurements</span> <span class="op">=</span> <span class="fu"><a href="../reference/neuromorpho_morphometry.html">neuromorpho_morphometry</a></span><span class="op">(</span><span class="va">metrics.neuron_name</span>, data_frame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign species column</span></span>
<span><span class="va">measurements</span><span class="op">$</span><span class="va">species</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"whale"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">whale.pyramidal.cells</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"elephant"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">elephant.pyramidal.cells</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"mouse"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mouse.pyramidal.cells</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Boxplot volume</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">volume</span><span class="op">)</span><span class="op">~</span><span class="va">species</span>, data<span class="op">=</span><span class="va">measurements</span>, notch<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>  col<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deepskyblue1"</span>,<span class="st">"firebrick1"</span>,<span class="st">"darkolivegreen1"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  main<span class="op">=</span><span class="st">"pyramidal neuron volumes"</span>, xlab<span class="op">=</span><span class="st">"species"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Boxplot length</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">length</span><span class="op">)</span><span class="op">~</span><span class="va">species</span>, data<span class="op">=</span><span class="va">measurements</span>, notch<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>  col<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deepskyblue1"</span>,<span class="st">"firebrick1"</span>,<span class="st">"darkolivegreen1"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  main<span class="op">=</span><span class="st">"pyramidal neuron length"</span>, xlab<span class="op">=</span><span class="st">"species"</span><span class="op">)</span></span></code></pre></div>
<p>So, it seems that whale neurons are a lot more voluminous than an
elephant’s, but less so in terms of cable length. Both are quite a lot
larger than those of a mouse.</p>
<p>Of course, to be sure, we would need to control by reconstruction
method and work harder to establish the exact cell type
correspondences.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Bates.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
